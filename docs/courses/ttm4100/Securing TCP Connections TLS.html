<!DOCTYPE html>
<html>
  <head>
    <!-- Katex -->
    <link rel="stylesheet" href=
        "https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">

    <!-- GitHub Markdown Styles -->
    <link rel="stylesheet" href=
        "https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"/>

    <title>Securing TCP Connections TLS.md</title>
    <link rel="icon" type="image/x-icon" href="../../">

    <!-- Custom Styles -->
    <link rel="stylesheet" href="../../styles.css">
  
  </head>

  <body class="markdown-body">
    <div class="page flex-row">
      <div class="links">
        <p></p>
<h4 id="courses%2Fttm4100" tabindex="-1"><a href="../index.html">courses/</a><a href="./index.html">ttm4100</a></h4>
<ul>
<li>ğŸ“‚ <a href="./assets/index.html">assets</a></li>
<li>ğŸ“„ <a href="5G Cellular Networks.html">5G Cellular Networks</a></li>
<li>ğŸ“„ <a href="Application Layer.html">Application Layer</a></li>
<li>ğŸ“„ <a href="calc.ipynb">calc</a></li>
<li>ğŸ“„ <a href="Cellular Networks 4G and 5G.html">Cellular Networks 4G and 5G</a></li>
<li>ğŸ“„ <a href="Computer Networks and the Internet.html">Computer Networks and the Internet</a></li>
<li>ğŸ“„ <a href="Connection-Oriented Transport TCP.html">Connection-Oriented Transport TCP</a></li>
<li>ğŸ“„ <a href="Connectionless Transport UDP.html">Connectionless Transport UDP</a></li>
<li>ğŸ“„ <a href="Delay, Loss, and Throughput in Packet-Switched Networks.html">Delay, Loss, and Throughput in Packet-Switched Networks</a></li>
<li>ğŸ“„ <a href="DNS - The Internet's Directory Service.html">DNS - The Internet's Directory Service</a></li>
<li>ğŸ“„ <a href="Electronic Mail in the Internet.html">Electronic Mail in the Internet</a></li>
<li>ğŸ“„ <a href="Error-Detection and -Correction Techniques.html">Error-Detection and -Correction Techniques</a></li>
<li>ğŸ“„ <a href="Evolution of Transport-Layer Functionality.html">Evolution of Transport-Layer Functionality</a></li>
<li>ğŸ“„ <a href="History of Computer Networking and the Internet.html">History of Computer Networking and the Internet</a></li>
<li>ğŸ“„ <a href="ICMP The Internet Control Message Protocol.html">ICMP The Internet Control Message Protocol</a></li>
<li>ğŸ“„ <a href="Introduction to the Control Plane in the Network Layer.html">Introduction to the Control Plane in the Network Layer</a></li>
<li>ğŸ“„ <a href="Introduction to the Link %25Layer.html">Introduction to the Link %Layer</a></li>
<li>ğŸ“„ <a href="Introduction to the Transport Layer and Transport Layer Services.html">Introduction to the Transport Layer and Transport Layer Services</a></li>
<li>ğŸ“„ <a href="Introduction to Wireless and Mobile Networks.html">Introduction to Wireless and Mobile Networks</a></li>
<li>ğŸ“„ <a href="Message Integrity and Digital Signatures.html">Message Integrity and Digital Signatures</a></li>
<li>ğŸ“„ <a href="Multimedia Networking Applications.html">Multimedia Networking Applications</a></li>
<li>ğŸ“„ <a href="Multimedia Networking.html">Multimedia Networking</a></li>
<li>ğŸ“„ <a href="Multiple Access Links and Protocols.html">Multiple Access Links and Protocols</a></li>
<li>ğŸ“„ <a href="Multiplexing and Demultiplexing in the Transport Layer.html">Multiplexing and Demultiplexing in the Transport Layer</a></li>
<li>ğŸ“„ <a href="Network-Layer Security IPsec and Virtual Private Networks.html">Network-Layer Security IPsec and Virtual Private Networks</a></li>
<li>ğŸ“„ <a href="Networks Under Attack.html">Networks Under Attack</a></li>
<li>ğŸ“„ <a href="Operational Security Firewalls and Intrusion Detection Systems.html">Operational Security Firewalls and Intrusion Detection Systems</a></li>
<li>ğŸ“„ <a href="Overview of Network Layer.html">Overview of Network Layer</a></li>
<li>ğŸ“„ <a href="Peer-to-Peer File Distribution.html">Peer-to-Peer File Distribution</a></li>
<li>ğŸ“„ <a href="Principles of Congestion Control.html">Principles of Congestion Control</a></li>
<li>ğŸ“„ <a href="Principles of Cryptography.html">Principles of Cryptography</a></li>
<li>ğŸ“„ <a href="Principles of Network Applications.html">Principles of Network Applications</a></li>
<li>ğŸ“„ <a href="Principles of Reliable Data Transfer.html">Principles of Reliable Data Transfer</a></li>
<li>ğŸ“„ <a href="Protocol Layers and Their Service Models.html">Protocol Layers and Their Service Models</a></li>
<li>ğŸ“„ <a href="protocol.html">protocol</a></li>
<li>ğŸ“„ <a href="Protocols for Real-Time Conversational Applications.html">Protocols for Real-Time Conversational Applications</a></li>
<li>ğŸ“„ <a href="Routing Algorithms.html">Routing Algorithms</a></li>
<li>ğŸ“„ <a href="Securing E-mail.html">Securing E-mail</a></li>
<li>ğŸ“„ <a href="Securing TCP Connections TLS.html">Securing TCP Connections TLS âœ¨</a></li>
<li>ğŸ“„ <a href="Security in Computer Networks.html">Security in Computer Networks</a></li>
<li>ğŸ“„ <a href="Socket Programming Creating Network Applications.html">Socket Programming Creating Network Applications</a></li>
<li>ğŸ“„ <a href="Streaming Stored Video.html">Streaming Stored Video</a></li>
<li>ğŸ“„ <a href="Switched Local Area Networks.html">Switched Local Area Networks</a></li>
<li>ğŸ“„ <a href="TCP Congestion Control.html">TCP Congestion Control</a></li>
<li>ğŸ“„ <a href="The Internet Protocol IP IPv4 Addressing IPv6 and More.html">The Internet Protocol IP IPv4 Addressing IPv6 and More</a></li>
<li>ğŸ“„ <a href="The Link Layer and LANs.html">The Link Layer and LANs</a></li>
<li>ğŸ“„ <a href="The Network Core.html">The Network Core</a></li>
<li>ğŸ“„ <a href="The Network Edge.html">The Network Edge</a></li>
<li>ğŸ“„ <a href="The Network Layer Control Plane.html">The Network Layer Control Plane</a></li>
<li>ğŸ“„ <a href="The Network Layer Data Plane.html">The Network Layer Data Plane</a></li>
<li>ğŸ“„ <a href="The Web and HTTP.html">The Web and HTTP</a></li>
<li>ğŸ“„ <a href="Transport Layer.html">Transport Layer</a></li>
<li>ğŸ“„ <a href="Video Streaming and Content Distribution Networks.html">Video Streaming and Content Distribution Networks</a></li>
<li>ğŸ“„ <a href="Voice-over-IP.html">Voice-over-IP</a></li>
<li>ğŸ“„ <a href="What is Network Security.html">What is Network Security</a></li>
<li>ğŸ“„ <a href="What is the Internet.html">What is the Internet</a></li>
<li>ğŸ“„ <a href="What's Inside a Router.html">What's Inside a Router</a></li>
<li>ğŸ“„ <a href="WiFi 802.11 Wireless LANs.html">WiFi 802.11 Wireless LANs</a></li>
<li>ğŸ“„ <a href="Wireless and Mobile Networks.html">Wireless and Mobile Networks</a></li>
<li>ğŸ“„ <a href="Wireless Links and Network Characteristics.html">Wireless Links and Network Characteristics</a>
</li>
</ul>

      </div>
      <article class="content">
        <h1 id="securing-tcp-connections-tls" tabindex="-1">Securing TCP Connections TLS</h1>
<h2 id="securing-tcp-connections%3A-tls" tabindex="-1">Securing TCP Connections: TLS</h2>
<p>You can identify that TLS is being used by your browser when the URL begins with https: rather than http.</p>
<p>TLS addresses these issues by enhancing TCP with confidentiality, data integrity, server authentication, and client authentication.</p>
<p>TLS is often used to provide security to transactions that take place over HTTP. However, because TLS secures TCP, it can be employed by any application that runs over TCP. TLS provides a simple Application Programmer Interface (API) with sockets, which is similar and analogous to TCPâ€™s API.</p>
<h3 id="the-big-picture" tabindex="-1">The Big Picture</h3>
<p>Almost-TLS (and TLS) has three phases: handshake, key derivation, and data transfer.</p>
<h4 id="handshake" tabindex="-1">Handshake</h4>
<p><img src="assets/2022-05-10-13-39-12.png" alt=""></p>
<h4 id="key-derivation" tabindex="-1">Key Derivation</h4>
<p>In principle, the master key (MS), now shared by Bob and Alice, could be used as the symmetric session key for all subsequent encryption and data integrity checking. It is, however, generally considered safer for Alice and Bob to each use different cryptographic keys, and also to use different keys for encryption and integrity checking. Thus, both Alice and Bob use the MS to generate four keys:</p>
<ul>
<li>EB = session encryption key for data sent from Bob to Alice</li>
<li>MB = session HMAC key for data sent from Bob to Alice, where HMAC is a standardized hashed message authentication code (MAC) that we encountered in section 8.3.2</li>
<li>EA = session encryption key for data sent from Alice to Bob</li>
<li>MA = session HMAC key for data sent from Alice to Bo</li>
</ul>
<h4 id="data-transfer" tabindex="-1">Data Transfer</h4>
<p>The HMAC is now a hash of the data plus the HMAC key MB plus the current sequence number.</p>
<p>Alice tracks Bobâ€™s sequence numbers, allowing her to verify the data integrity of a record by including the appropriate sequence number in the HMAC calculation. This use of TLS sequence numbers prevents Trudy from carrying out a woman-in-the-middle attack, such as reordering or replaying segments.</p>
<h4 id="tls-record" tabindex="-1">TLS Record</h4>
<p><img src="assets/2022-05-10-13-43-59.png" alt=""></p>
<h3 id="a-more-complete-picture" tabindex="-1">A More Complete Picture</h3>
<h4 id="tls-handshake" tabindex="-1">TLS Handshake</h4>
<p>TLS allows Alice and Bob to agree on the cryptographic algorithms at the beginning of the TLS session, during the handshake phase. Additionally, during the handshake phase, Alice and Bob send nonces to each other, which are used in the creation of the session keys (EB, MB, EA, and MA). The steps of the real TLS handshake are as follows:</p>
<ol>
<li>The client sends a list of cryptographic algorithms it supports, along with a client nonce.</li>
<li>From the list, the server chooses a symmetric algorithm (for example, AES) and a public key algorithm (for example, RSA with a specific key length), and HMAC algorithm (MD5 or SHA-1) along with the HMAC keys. It sends back to the client its choices, as well as a certificate and a server nonce.</li>
<li>The client verifies the certificate, extracts the serverâ€™s public key, generates a Pre-Master Secret (PMS), encrypts the PMS with the serverâ€™s public key, and sends the encrypted PMS to the server.</li>
<li>Using the same key derivation function (as specified by the TLS standard), the client and server independently compute the Master Secret (MS) from the PMS and nonces. The MS is then sliced up to generate the two encryption and two HMAC keys. Furthermore, when the chosen symmetric cipher employs CBC (such as 3DES or AES), then two Initialization Vectors (IVs)â€”one for each side of the connectionâ€”are also obtained from the MS. Henceforth, all messages sent between client and server are encrypted and authenticated (with the HMAC).</li>
<li>The client sends the HMAC of all the handshake messages.</li>
<li>The server sends the HMAC of all the handshake messages.</li>
</ol>
<p>The server can compare this HMAC with the HMAC of the handshake messages it received and sent. If there is an inconsistency, the server can terminate the connection.</p>
<p>in TLS, nonces are used to defend against the â€œconnection replay attackâ€ and sequence numbers are used to defend against replaying individual packets during an ongoing session.</p>
<h4 id="connection-closure" tabindex="-1">Connection Closure</h4>
<p>having Bob send a TCP FIN segment to Alice. But such a naive design sets the stage for the truncation attack whereby Trudy once again gets in the middle of an ongoing TLS session and ends the session early with a TCP FIN.</p>
<p>The solution to this problem is to indicate in the type field whether the record serves to terminate the TLS session.</p>

      </article>
      </div>
  </body>
</html>
