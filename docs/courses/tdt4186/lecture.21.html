<!DOCTYPE html>
<html>

<head>
  <!-- Katex -->
  <link rel="stylesheet" href=
      "https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">

  <!-- GitHub Markdown Styles -->
  <link rel="stylesheet" href=
      "https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css"/>

  <title>lecture.21.md</title>
  <link rel="icon" type="image/x-icon" href="../../null">

  <!-- Custom Styles -->
  <link rel="stylesheet" href="../../styles.css">
  
</head>

<body class="markdown-body">
  <div class="sticky">
    <div class="absolute">
      <p>‚Ü©Ô∏è <a href="./index.html">tdt4186</a>
‚Ü©Ô∏è <a href="../index.html">courses</a></p>
<h3>tdt4186</h3>
<ul>
<li>üìÇ <a href="./assets/index.html">assets</a></li>
<li>üìÑ <a href="compendium.html">compendium.html</a></li>
<li>üìÑ <a href="lecture.1.html">lecture.1.html</a></li>
<li>üìÑ <a href="lecture.10.html">lecture.10.html</a></li>
<li>üìÑ <a href="lecture.11.html">lecture.11.html</a></li>
<li>üìÑ <a href="lecture.12.html">lecture.12.html</a></li>
<li>üìÑ <a href="lecture.13.html">lecture.13.html</a></li>
<li>üìÑ <a href="lecture.14.html">lecture.14.html</a></li>
<li>üìÑ <a href="lecture.15.html">lecture.15.html</a></li>
<li>üìÑ <a href="lecture.16.html">lecture.16.html</a></li>
<li>üìÑ <a href="lecture.17.html">lecture.17.html</a></li>
<li>üìÑ <a href="lecture.18.html">lecture.18.html</a></li>
<li>üìÑ <a href="lecture.19.html">lecture.19.html</a></li>
<li>üìÑ <a href="lecture.2.html">lecture.2.html</a></li>
<li>üìÑ <a href="lecture.20.html">lecture.20.html</a></li>
<li>üìÑ <a href="lecture.21.html">lecture.21.html</a></li>
<li>üìÑ <a href="lecture.22.html">lecture.22.html</a></li>
<li>üìÑ <a href="lecture.3.html">lecture.3.html</a></li>
<li>üìÑ <a href="lecture.4.html">lecture.4.html</a></li>
<li>üìÑ <a href="lecture.5.html">lecture.5.html</a></li>
<li>üìÑ <a href="lecture.6.html">lecture.6.html</a></li>
<li>üìÑ <a href="lecture.7.html">lecture.7.html</a></li>
<li>üìÑ <a href="lecture.8.html">lecture.8.html</a></li>
<li>üìÑ <a href="lecture.9.html">lecture.9.html</a></li>
<li>üìÑ <a href="questions.html">questions.html</a>
</li>
</ul>

    </div>
  </div>
  <article>
    <h2>Lecture 21: OS Security 1</h2>
<p><a href="lecture.20.html">Previous lecture</a>
<a href="lecture.22.html">Next lecture</a></p>
<p><iframe width="560" height="315" src="https://www.youtube.com/embed/xScnPCeFPYs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe></p>
<h3>Exam</h3>
<p>Security and its management in the OS</p>
<p><strong>Important questions:</strong></p>
<ul>
<li>Can you define safety and security?</li>
<li>What is the task of OS security?</li>
<li>Can you give examples for malware?</li>
<li>What is the difference to social engineering?</li>
<li>Which types of malware exist, can you define them?</li>
<li>What is permission management and what are the related requirements?</li>
<li>What is the principle of least privilege?</li>
<li>Define the access matrix and describe the ways to use it</li>
<li>File/process attributes in Unix</li>
<li>ACLs, capabilities, mandatory access control</li>
<li>How do the MMU and the CPU privilege levels contribute to security?</li>
<li>What is software-based protection, can you give an example?</li>
<li>Which typical software bugs contribute to security problems, can you give examples?</li>
</ul>
<h3>Overview</h3>
<ul>
<li>Overview of security problems</li>
<li>Permission management</li>
<li>System software and security</li>
<li>Software bugs</li>
<li>Examples</li>
<li>Conclusions</li>
</ul>
<h3>Security problems</h3>
<ul>
<li>Definitions of relevant terms
<ul>
<li><strong>Safety</strong>
<ul>
<li>protection against risks due to hardware and software errors or failures</li>
</ul>
</li>
<li><strong>Security</strong>
<ul>
<li>protection of users and computers against intended errors (attacks)</li>
</ul>
</li>
</ul>
</li>
<li>Both topics are highly relevant for system software
<ul>
<li>Today, we will only discuss security</li>
</ul>
</li>
<li>Exploitation of security holes
<ul>
<li>malware</li>
<li>social engineering</li>
</ul>
</li>
</ul>
<h3>Operating system security</h3>
<ul>
<li><em>Someone...</em>
<ul>
<li>differentiation of persons and groups of persons</li>
</ul>
</li>
<li><em>has to be deterred from doing...</em>
<ul>
<li>using technical and organizational methods</li>
</ul>
</li>
<li><em>some...</em>
<ul>
<li>limited only by our imagination</li>
</ul>
</li>
<li><em>unexpected things!</em>
<ul>
<li>
<ol>
<li>unauthorized reading of data (secrecy, confidentiality),</li>
</ol>
</li>
<li>
<ol start="2">
<li>unauthorized writing of data (integrity),</li>
</ol>
</li>
<li>
<ol start="3">
<li>working under a "false flag" (authenticity),</li>
</ol>
</li>
<li>
<ol start="4">
<li>unauthorized use of resources (availability),</li>
</ol>
</li>
<li>etc‚Ä¶</li>
</ul>
</li>
<li>Differentiation between
<ul>
<li>internal</li>
<li>and external attacks</li>
</ul>
</li>
</ul>
<h3>Example: fake login screen</h3>
<ul>
<li>Attacker starts a user program that simulates a login screen</li>
<li>The unsuspecting user enters username and (secret) password
<ul>
<li>Attacker program records user name and password</li>
<li>Attacker program terminates the current shell</li>
</ul>
</li>
<li>Login session of the attacker is closed and the regular login screen appears
<ul>
<li>User assumes incorrectly typed password</li>
</ul>
</li>
<li>Remedy: require the user to start the login sequence using a key combination that cannot be intercepted by a user program
<ul>
<li>e.g. CTRL-ALT-DEL in Windows NT and following</li>
</ul>
</li>
</ul>
<h3>Malware example: viruses</h3>
<ul>
<li>Program code inserted into another program, which can be replicated this way
<ul>
<li>Virus sleeps until the infected program is executed</li>
<li>Start of the infected program results in virus reproduction</li>
<li>Execution of the virus functionality can be time-controlled</li>
</ul>
</li>
<li>Sorts of viruses
<ul>
<li>Boot sector virus: executed at system startup time</li>
<li>Macro virus: in scriptable programs, e.g. Word, Excel
<ul>
<li>Reproduced through documents (e.g. sent by email)!</li>
</ul>
</li>
<li>Executable program as virus</li>
</ul>
</li>
<li>Distribution through‚Ä¶
<ul>
<li>exchange of storage media (USB memory sticks etc.)</li>
<li>email attachments</li>
<li>web pages</li>
</ul>
</li>
</ul>
<h3>Example: social engineering</h3>
<ul>
<li>Not a system software problem
<ul>
<li>‚Ä¶but very important</li>
</ul>
</li>
<li>Gain access to information by exploiting human errors
<ul>
<li><strong>Phishing</strong>
<ul>
<li>obtain data of an internet user using forged addresses (e.g. with similar names/typos)</li>
<li>e.g. by using forged emails from banks or government institutions</li>
</ul>
</li>
<li><strong>Pharming</strong>
<ul>
<li>manipulation of DNS requests by web browsers</li>
<li>redirect accesses, e.g. to forged bank websites</li>
<li>most users ignore browser warnings about invalid security certificates</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Types of malware</h3>
<ul>
<li><strong>Viruses</strong>
<ul>
<li>programs inadvertently distributed by a user</li>
<li>infect other programs</li>
<li>‚Ä¶and reproduce this way</li>
</ul>
</li>
<li><strong>Worms</strong>
<ul>
<li>do not wait for user actions to propagate to another computer</li>
<li>actively try to invade new systems</li>
<li>exploit security holes on target systems</li>
</ul>
</li>
<li><strong>Trojan horses ("trojans")</strong>
<ul>
<li>program disguised as useful application (or game‚Ä¶)</li>
<li>in addition to the useful function, additional functionality is provided without the user noticing, e.g. providing an attacker with access to the local computer via internet</li>
</ul>
</li>
<li><strong>Root kit</strong>
<ul>
<li>collection of software tools to...
<ul>
<li>disguise future logins of an attacker</li>
<li>hide processes and files</li>
</ul>
</li>
<li>is installed after a computer system is compromised</li>
<li>can hide itself and its activities from the user
<ul>
<li>e.g. by manipulating tools to display processes (ps), directory contents (ls), network connections (netstat) ...</li>
<li>‚Ä¶or by manipulating system-wide shared libraries (libc)</li>
<li>‚Ä¶or directly by manipulating the OS kernel</li>
</ul>
</li>
</ul>
</li>
<li>Often, malware uses a combination of these types</li>
</ul>
<h3>Permission management: objectives</h3>
<ul>
<li>Protect stored information from
<ul>
<li>breach of confidentiality</li>
<li>theft of information</li>
<li>unwanted manipulation (including encryption: ransomware)</li>
</ul>
</li>
<li>in all multi-user systems
<ul>
<li>‚Ä¶and every system connected to the Internet is in fact a multi-user system!</li>
</ul>
</li>
</ul>
<h3>Permission management: requirements</h3>
<ul>
<li>All <em>objects</em> of a system must be uniquely and unforgeably identifiable</li>
<li>(external) <em>users</em> of a system must be uniquely and unforgeably identifiable ‚ûõ authentication</li>
<li>Access to objects allowed only if the user has the required <em>permissions</em></li>
<li>Access to objects should only be allowed using the appropriate object management
<ul>
<li>permissions must be stored in an unforgeable way; transfer of permissions must only take place it a controlled way</li>
<li>it must be possible to validate basic protection mechanisms with low overhead</li>
</ul>
</li>
</ul>
<h3>Permission management: design principles</h3>
<ul>
<li><em>Principle of least privilege</em>
<ul>
<li>Allow a person or software component only those permissions that are required for the functionality to be realized</li>
<li>Standard case: deny permission</li>
<li>Counterexample: Unix "root"</li>
</ul>
</li>
<li><em>Fail-safe defaults</em>
<ul>
<li>Example: newly installed server software</li>
</ul>
</li>
<li><em>Separation of duties</em>
<ul>
<li>Multiple conditions exist to allow an operation</li>
</ul>
</li>
</ul>
<h3>Access matrix</h3>
<ul>
<li>Elements of the matrix:
<ul>
<li>Subjects (persons/users, processes)</li>
<li>Objects (data, devices, processes, memory, ‚Ä¶)</li>
<li>Operations (read, write, delete, execute, ‚Ä¶)</li>
</ul>
</li>
<li>Question: Is <code><span class="hljs-function"><span class="hljs-title">operation</span><span class="hljs-params">(subject, object)</span></span></code> permitted? Objects Subjects Permissions</li>
</ul>
<p><img src="assets/Pasted image 20220328153626.png" alt=""></p>
<h3>Basic model: file/process attributes</h3>
<ul>
<li>Properties related to a user:
<ul>
<li>for which user is the process being executed?</li>
<li>which user is the owner of a file?</li>
<li>which permissions does the owner of a file give to him/ herself and which permissions to other users?</li>
</ul>
</li>
<li>Permissions of a process when accessing a file
<ul>
<li>Attributes of processes: user ID</li>
<li>Attributes of files: owner ID</li>
</ul>
</li>
</ul>
<p><img src="assets/Pasted image 20220328153939.png" alt=""></p>
<h3>Access matrix variants</h3>
<ul>
<li>Colums: <em>ACL ‚Äì Access Control Lists</em>
<ul>
<li>for every access to an object, the access permissions are validated based on the identity of the requesting subject (user)</li>
</ul>
</li>
<li>Rows: <em>Capabilities</em>
<ul>
<li>for every access to an object a property is validated which is owned by the subject and which can be passed to other subjects on demand</li>
</ul>
</li>
<li>Rule-based: <em>mandatory access control</em>
<ul>
<li>rules are evaluated for every access</li>
</ul>
</li>
</ul>
<h4>ACLs</h4>
<ul>
<li>Column-wise view of the access matrix: Access Control List (ACL)</li>
<li>ACLs indicate for every object which subjects are allowed to perform which operations on it</li>
<li>ACLs can be configured by‚Ä¶
<ul>
<li>subjects having an appropriate ACL entry granting this permission</li>
<li>the creator of the object (file)</li>
</ul>
</li>
<li>Example: Multics OS ‚Äì triplet (user, group, permissions)</li>
</ul>
<pre><code class="hljs">File <span class="hljs-number">0</span> <span class="hljs-comment">(Jan, *, RWX)</span>
File <span class="hljs-number">1</span> <span class="hljs-comment">(Jan, system, RWX)</span>
File <span class="hljs-number">2</span> <span class="hljs-comment">(Jan, *, RW-)</span>, <span class="hljs-comment">(Els, staff, R--)</span>, <span class="hljs-comment">(Maike, _, RW-)</span>
File <span class="hljs-number">3</span> <span class="hljs-comment">(_, student, R--)</span>
File <span class="hljs-number">4</span> <span class="hljs-comment">(Jelle, _,---)</span>, <span class="hljs-comment">(_, student, R--)</span>
</code></pre>
<ul>
<li>Windows (starting with NT)
<ul>
<li>object: allow, deny</li>
<li>full control, modify, read&amp;execute,</li>
</ul>
</li>
</ul>
<h3>Unix access permissions</h3>
<ul>
<li>Unix: simple access control lists</li>
<li>Processes have a user ID and a group ID</li>
<li>Files have an owner and a group</li>
<li>Permissions are related to the user (owner), group, and all others</li>
</ul>
<p><img src="assets/Pasted image 20220328154651.png" alt=""></p>
<h3>Problem: permission extensions</h3>
<ul>
<li>Example ‚Äì keep a high score list for a game
<ul>
<li>High score list: /home/me/games/tetris/highscores</li>
<li>Program: /home/me/bin/games/tetris</li>
</ul>
</li>
<li>Every player should be able to enter his/her own high score</li>
</ul>
<ol>
<li>all users have write permission to the high score list
<ul>
<li>too many permissions (does not work)</li>
<li>every user could arbitrarily manipulate the high score list</li>
</ul>
</li>
<li>SetUID: only "me" has write permissions
<ul>
<li>Tetris program has "setuid" permissions</li>
<li>as soon as the Tetris program is executed, the process is assigned the user ID of the owner of the executable program</li>
</ul>
</li>
</ol>
<h3>Unix: users and processes</h3>
<ul>
<li>Each process represents a user
<ul>
<li>Process attributes:</li>
<li>User ID (uid), group ID (gid)</li>
<li>Effective uid (euid), effective gid (egid)
<ul>
<li>Determine permissions of a process when accessing files</li>
</ul>
</li>
</ul>
</li>
<li>Only a few highly privileged processes are allowed to change their uid and gid
<ul>
<li>e.g. the login process</li>
</ul>
</li>
<li>After verifying the user‚Äôs password, the login process sets uid, gid, euid and egid
<ul>
<li>All other processes: children of login</li>
</ul>
</li>
<li>Child processes inherit the parent attributes</li>
</ul>
<p><img src="assets/Pasted image 20220328155022.png" alt=""></p>
<h3>Unix solution: setuid mechanism</h3>
<ul>
<li>File which contains trustworthy program code (e.g. Tetris) is given an additional permission bit: setuid (s bit)
<ul>
<li>shown as "s" instead of "x" for executable in directory listing</li>
<li>there is also a setgid bit (rarely used)</li>
</ul>
</li>
<li>exec of setuid programs:
<ul>
<li>executing process obtains the UID of the program owner as effective UID</li>
<li>precisely: the UID of the file containing the program</li>
</ul>
</li>
<li>Process execution performed using the permissions of this user as long as the program is not terminated
<ul>
<li>Contradicts the principle of least privilege
<ul>
<li>Workaround: create special user for the application instead of using "root"</li>
</ul>
</li>
<li>It is considered good programming style to return any setuid permissions as soon as they are no longer required by a process</li>
</ul>
</li>
</ul>
<h3>Example: high score list</h3>
<p><img src="assets/Pasted image 20220328155454.png" alt=""></p>
<h3>Example: high score list (2)</h3>
<p><img src="assets/Pasted image 20220328155633.png" alt=""></p>
<h3>Example: high score list (3)</h3>
<p><img src="assets/Pasted image 20220328155643.png" alt=""></p>
<h3>setuid problems</h3>
<ul>
<li>Extension of the permissions of a user exactly for the case of using the given program
<ul>
<li>"Owner" of the program trusts the user who is using the program
<ul>
<li>Owner can be the administrator, but also normal users</li>
</ul>
</li>
</ul>
</li>
<li>Problem: program bugs
<ul>
<li>can result in significant permission extensions</li>
<li>e.g. enable calling a shell (with inherited permissions of the owner of the setuid process) from such a program</li>
</ul>
</li>
<li>Practical experience: still to many permissions granted!</li>
</ul>
<h3>Capabilities</h3>
<ul>
<li>Row-wise view of the access matrix: Capability</li>
<li>Capabilities indicate for each subject in which ways it is allowed to access which objects</li>
</ul>
<p><img src="assets/Pasted image 20220402114911.png" alt=""></p>
<h3>Example</h3>
<ul>
<li>Basic implementation: Unix file descriptors</li>
<li>Propagated using the fork system call
<ul>
<li>Allows access to files without repeated validation of the Unix access permissions</li>
</ul>
</li>
</ul>
<p><img src="assets/Pasted image 20220402114941.png" alt=""></p>
<h3>Rule-based access matrix</h3>
<ul>
<li>Mandatory Access Control</li>
<li>Concept:
<ul>
<li>subjects and objects possess attributes ("labels")</li>
<li>decision about granting access by evaluating rules</li>
</ul>
</li>
<li>Implemented in "security kernels", e.g. SELinux</li>
</ul>
<p><img src="assets/Pasted image 20220402115350.png" alt=""></p>
<h3>System software and security</h3>
<ul>
<li>Hardware-based protection
<ul>
<li>MMU</li>
<li>protection rings</li>
</ul>
</li>
<li>‚Ä¶complemented by protection in the system software
<ul>
<li>Exclusive control of the hardware by the OS</li>
<li>Exclusive control of all processes</li>
<li>Exclusive control of all resources</li>
<li>Provisioning of
<ul>
<li>identification mechanisms</li>
<li>authentication mechanisms</li>
<li>privilege separation</li>
<li>cryptographic protection of information</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Hardware-based protection: MMU</h3>
<ul>
<li>Memory Management Unit
<ul>
<li>Hardware component of the CPU that translates and controls program accesses to memory</li>
<li>Translation of the process view (virtual addresses) into the hardware view (physical addresses)</li>
</ul>
</li>
<li>Main memory is partitioned into pages</li>
<li>Protection by...
<ul>
<li>only mapping the exact set of required main memory pages into the virtual address space of a process</li>
<li>isolation of the physical address spaces of different processes</li>
<li>protection bits for each page, controlled at every access
<ul>
<li>read/write/execute code</li>
<li>access permitted in user mode/supervisor mode</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Protection rings</h3>
<ul>
<li>Privilege concept
<ul>
<li>All code is executed in the context of a given protection ring</li>
<li>Code running in ring 0 has access to all system resources</li>
<li>User programs run in ring 3</li>
<li>Rings 1 &amp; 2 for OS-like code
<ul>
<li>e.g. device drivers</li>
</ul>
</li>
</ul>
</li>
<li>Rings restrict‚Ä¶
<ul>
<li>the usable subset of processor machine instructions
<ul>
<li>e.g. disabling interrupts (sei/cli) not permitted in rings &gt; 0</li>
</ul>
</li>
<li>the accessible address range for the process
<ul>
<li>disabling of I/O accesses</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Software-based protection</h3>
<ul>
<li>Identification mechanisms</li>
<li>Unix: user and group identification
<ul>
<li>Numeric value</li>
<li>Translated into texts (user and group names) durch lookup in /etc/passwd</li>
</ul>
</li>
<li>Resources are assigned an owner</li>
<li>Superuser: uid = 0
<ul>
<li>Has all permissions possible in the system</li>
</ul>
</li>
</ul>
<h3>Software-based protection (2)</h3>
<ul>
<li>Authentication mechanisms
<ul>
<li>Unix login</li>
<li>Reads user name and password</li>
<li>Verification of the entered password with the one recorded in the system
<ul>
<li>Either by encrypting the entered password and comparison with the recorded encrypted value</li>
<li>Or by verification of a hash value</li>
</ul>
</li>
<li>The login process then starts the first user process (e.g., a shell) with the uid and gid of this user</li>
</ul>
</li>
</ul>
<p><img src="assets/Pasted image 20220402120030.png" alt="">
<img src="assets/Pasted image 20220402120037.png" alt=""></p>
<h3>Software-based protection (3)</h3>
<ul>
<li>Cryptographic protection of information
<ul>
<li>e.g. DES encryption of user passwords</li>
<li>Originally in Unix stored in the file /etc/passwd</li>
</ul>
</li>
</ul>
<pre><code class="hljs">root:<span class="hljs-number">4</span>t6f4rt3423:<span class="hljs-number">0</span>:<span class="hljs-number">0</span>:System Administrator:<span class="hljs-regexp">/var/</span>root:<span class="hljs-regexp">/bin/</span>sh
daemon:ge53r3rfrg:<span class="hljs-number">1</span>:<span class="hljs-number">1</span>:System Services:<span class="hljs-regexp">/var/</span>root:<span class="hljs-regexp">/usr/</span>bin/<span class="hljs-literal">false</span>
me:<span class="hljs-number">1</span>x3Fe5<span class="hljs-symbol">$gRd</span>:<span class="hljs-number">1000</span>:<span class="hljs-number">1000</span>:Michael Engel:<span class="hljs-regexp">/home/m</span>e:<span class="hljs-regexp">/bin/</span>bash
</code></pre>
<ul>
<li>Problem: encrypted passwords were readable for all users!
<ul>
<li>‚Ä¶could be decrypted using a "brute force" attack given enough time</li>
<li>readily available tools, e.g. "John the Ripper"</li>
</ul>
</li>
<li>Today: only user information stored in /etc/passwd
<ul>
<li>Passwords are now stored separately in /etc/shadow!</li>
</ul>
</li>
</ul>
<pre><code class="hljs">-rw-r--r--<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 1353 </span>May<span class="hljs-number"> 28 </span>22:43 /etc/passwd
-rw-r-----<span class="hljs-number"> 1 </span>root shadow<span class="hljs-number"> 901 </span>May<span class="hljs-number"> 28 </span>22:43 /etc/shadow
</code></pre>
<h3>Software bugs</h3>
<ul>
<li>Trade-off: performance ‚Üî security</li>
<li>C, C++, Assembler: unmanaged languages
<ul>
<li>Pointers, array bounds, value overflows</li>
</ul>
</li>
<li>C#, Java: managed languages
<ul>
<li>Not usable for system software development!</li>
<li>‚Ä¶why?</li>
<li>Managed languages also have security problems!</li>
</ul>
</li>
<li>Problems
<ul>
<li>Buffer overflows</li>
<li>Value range overflows</li>
</ul>
</li>
<li>Error statistics
<ul>
<li>One error per 1000 lines of code on average</li>
<li>Independent of the implementation language!</li>
</ul>
</li>
</ul>
<h3>Value ranges</h3>
<ul>
<li>Problem: integer numbers are represented as bit strings with a limited number of bits</li>
<li>Example: "char" data type in C
<ul>
<li>Represented as signed 8 bit value</li>
<li>Value range:-27 ... +27 ‚Äì 1</li>
<li>‚Ä¶or-128 ... +127</li>
</ul>
</li>
<li>The C code results in the following calculation in binary:</li>
<li>Only the least significant 8 bits are significant
<ul>
<li>thus the result =-126! char a = 127; char b = 3; char result = a + b;</li>
</ul>
</li>
</ul>
<pre><code class="hljs"><span class="hljs-attribute">char a</span> = 127;
<span class="hljs-attribute">char b</span> = 3;
<span class="hljs-attribute">char result</span> = a + b;
</code></pre>
<pre><code class="hljs"> <span class="hljs-number">01111111</span> (<span class="hljs-name">a</span>)
<span class="hljs-number">+00000011</span> (<span class="hljs-name">b</span>)
 <span class="hljs-number">10000010</span> (<span class="hljs-name">result</span> is negative!)
</code></pre>
<h3>Value ranges (2)</h3>
<ul>
<li>The following code results in problems:</li>
</ul>
<pre><code class="hljs">
<span class="hljs-built_in">char</span> <span class="hljs-built_in">string</span>[<span class="hljs-number">127</span>] = <span class="hljs-string">"Hello World!\n"</span>
<span class="hljs-built_in">char</span> a = <span class="hljs-number">127</span>;
<span class="hljs-built_in">char</span> b = <span class="hljs-number">3</span>;
...
<span class="hljs-function"><span class="hljs-built_in">char</span> <span class="hljs-title">myfunc</span>(<span class="hljs-params"><span class="hljs-built_in">char</span> *<span class="hljs-built_in">string</span>, <span class="hljs-built_in">char</span> index</span>)</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">string</span>[index];
}
...
printf(<span class="hljs-string">"%x"</span>, myfunc(<span class="hljs-built_in">string</span>, a+b));

</code></pre>
<h3>Heap overflow</h3>
<ul>
<li>Heap: memory area for dynamically allocated data (e.g. via malloc)</li>
<li>Buffer overflows in the heap can be problematic
<ul>
<li>Memory ranges separately allocated with malloc can be contiguous in main memory</li>
<li>There are no checks for overflows</li>
<li>By passing incorrect sizes for data regions, an attacker can overwrite other data on the heap</li>
</ul>
</li>
<li>Example: Microsoft JPEG GDI+ (MS04-028)
<ul>
<li>Size values in JPEG image files were not controlled</li>
<li>"Normal" images files contain valid values
<ul>
<li>These do not result in erroneous behavior</li>
</ul>
</li>
<li>Manipulated image files contain invalid values
<ul>
<li>Overwrite other data on the heap</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Heap overflow (2)</h3>
<pre><code class="hljs"><span class="hljs-meta">#<span class="hljs-keyword">define</span> BUFSIZE 16</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> OVERSIZE 8 <span class="hljs-comment">/* overflow buf2 by OVERSIZE bytes */</span></span>

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>{
	u_long diff;
	<span class="hljs-type">char</span> *buf1 = <span class="hljs-built_in">malloc</span>(BUFSIZE),
	     *buf2 = <span class="hljs-built_in">malloc</span>(BUFSIZE);

	diff = (u_long)buf2- (u_long)buf1;
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"buf1 = %p, buf2 = %p, diff = 0x%x\n"</span>, buf1, buf2, diff);

	<span class="hljs-built_in">memset</span>(buf2, <span class="hljs-string">&#x27;A&#x27;</span>, BUFSIZE<span class="hljs-number">-1</span>);
	buf2[BUFSIZE<span class="hljs-number">-1</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;

	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"before overflow: buf2 = %s\n"</span>, buf2);
	<span class="hljs-built_in">memset</span>(buf1, <span class="hljs-string">&#x27;B&#x27;</span>, (u_int)(diff + OVERSIZE));
	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"after overflow: buf2 = %s\n"</span>, buf2);
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3>Result‚Ä¶</h3>
<ul>
<li>The value range is exceeded by 8 bytes</li>
</ul>
<p><img src="assets/Pasted image 20220402121348.png" alt=""></p>
<ul>
<li>buf1 exceeds its limit and arrives at the heap area in which buf2 is stored</li>
<li>This heap area of buf2 still has valid contents</li>
<li>Thus, the program does not terminate, but rather unexpectedly manipulates the data stored in buf2!</li>
</ul>
<h3>Unix Morris worm (sendmail)</h3>
<ul>
<li>One of the first worms distributed over the Internet</li>
<li>Written by a student of Cornell University, Robert Tappan Morris, and activated on November 2, 1988, from a computer at the MIT
<ul>
<li>From the MIT to disguise the real origin of the worm</li>
<li>Today, Robert Tappan Morris is professor at the MIT! :-)</li>
</ul>
</li>
<li>Exploited a security hole in the sendmail system
<ul>
<li>Buffer overflow in gets()</li>
<li>Written to determine the size of the Internet, should infect each system only once</li>
<li>‚Ä¶but had a fatal bug in its replication function!</li>
</ul>
</li>
<li>6000 Unix systems infected
<ul>
<li>Cost of fixing damages estimated between US$10 and US$100 million</li>
<li>‚Ä¶Morris was convicted to 3 years jail on probation and a US$10.000 fine...</li>
</ul>
</li>
</ul>
<h3>Michelangelo virus</h3>
<ul>
<li>First discovered in New Zealand in 1991</li>
<li>Boot sector virus, infects e.g. MS-DOS systems
<ul>
<li>Only uses BIOS functions, no DOS system calls</li>
</ul>
</li>
<li>Time-activated virus, active on March 6th</li>
<li>Overwrites the first 100 sectors of the (first) hard disk with zeros</li>
<li>Distribution using boot sectors of floppy disks
<ul>
<li>Installed itself in the boot sector of the hard disk</li>
</ul>
</li>
<li>One of the first viruses broadly discussed in the media
<ul>
<li>‚Ä¶but its effects were spectacularly exaggerated ;-)</li>
</ul>
</li>
<li>Some commercial software was accidentally delivered on disks with a boot sector virus
<ul>
<li>Today: viruses on USB memory sticks, mobile phones with USB interfaces, ‚Ä¶fresh from the factory!</li>
</ul>
</li>
</ul>
<h3>Sony BMG root kit</h3>
<ul>
<li>Software on copy protected CD-ROMs with Digital "Rights" Management (DRM) technology
<ul>
<li>Filtering driver for CD-ROM drives and IDE disk controllers to control access to media</li>
<li>Installed without informing the user or asking for approval</li>
</ul>
</li>
<li>Control over the use of data of Sony BMG
<ul>
<li>‚Ä¶on Windows systems</li>
</ul>
</li>
<li>Hidden from analysis using root kit functionality
<ul>
<li>Does not appear in the installed software list of the Windows control center and is not removable using uninstaller tools</li>
<li>Does not only hide related files, directories, processes and registry entries, but globally everything starting with the string <code><span class="hljs-meta"><span class="hljs-keyword">$sys</span>$</span></code></li>
<li>Enables other malware to hide itself using this root kit functionality!</li>
</ul>
</li>
</ul>
<h3>Blue Pill ‚Äì VM-based root kit</h3>
<ul>
<li>Discovery and removal of root kits on OS level is possible
<ul>
<li>But costly</li>
</ul>
</li>
<li>Objective: "undiscoverable" root kit</li>
<li>"Blue Pill" tried to infect a PC with a root kit without requiring a system reboot
<ul>
<li>Exploits hardware virtualization technology of current CPUs</li>
<li>No (significant) performance impact</li>
<li>All devices, e.g. GPUs, continue to be fully available to the OS</li>
</ul>
</li>
<li>Undiscoverable, since the OS does not notice that it is now running in a virtual machine
<ul>
<li>‚Ä¶but there are still side effects that enable the detection of root kits like this</li>
</ul>
</li>
</ul>
<h3>Conclusion</h3>
<ul>
<li>Security gains increasing relevance in networked environments
<ul>
<li>Extremely significant damages due to viruses, phishing, bot nets, ransomware, ...</li>
<li>Experienced computer users are not safe either!</li>
</ul>
</li>
<li>Security checks in code are essential!
<ul>
<li>Automated tests cannot find all errors; manual audits still required</li>
<li>Still, security problems are unavoidable
<ul>
<li>Thus, system software has to be constantly updated</li>
</ul>
</li>
</ul>
</li>
<li>Whack-a-mole game‚Ä¶
<ul>
<li>"Zero day exploits", newly discovered security holes which are not yet published (or fixed) are extremely dangerous</li>
<li>Reaction time of system software vendors are in the range of hours to months‚Ä¶</li>
</ul>
</li>
<li>Hardware is also increasingly problematic: "Meltdown" and "Spectre"</li>
</ul>

  </article>
</body>

</html>
